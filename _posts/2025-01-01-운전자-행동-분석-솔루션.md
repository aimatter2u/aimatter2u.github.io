# Portfolio

## **📝 1. 포트폴리오 개요**

![solution_](/assets/img/solution.png)
- 프로젝트 명 : 영상 기반 운전자 행동 분석  

- 기획 및 실행 : 권대현

- 수행 기간 : 8월 17일-8월 26일

- 주요 기술 스택 : 파이썬, 텐서플로우

- 프로젝트 구상 동기 및 목적 :
    - 운전 중 발생하는 위험 행동(졸음운전, 주의 산만 등)을 탐지하여 사고 예방을 목적으로 하는 AI 모델 개발
    - 교통사고를 줄이고 도로 안전을 높이기 위한 기술적 해결책 제공
    - 실시간 운전 행동 모니터링 시스템 구축을 통해 사고율 감소 기여
    - 운전자 행동 데이터를 기반으로 위험한 행동을 분류하고 예측하는 AI 모델을 구축
    - 향후 차량 내부 시스템에 통합 가능한 실시간 분석 시스템 구현

## **📚 2. 문제정의**

- 운전 중 주의 산만 문제
    - 운전 중 주의가 산만해질 경우 시각적 집중력이 떨어지며, 이는 교통사고로 이어질 가능성이 높음 
    - 예를 들어, 휴대폰을 사용하거나 내비게이션을 조작하는 등 시각적 주의가 분산되면 도로의 중요한 정보를 놓치게 됨
    - 이러한 주의 산만은 운전자의 즉각적인 반응을 저해하여 사고 발생 확률을 증가시킴

-  반응 시간 지연의 문제
    - 운전자가 집중력을 잃을 때 반응 시간이 지연되어 사고를 유발할 수 있음
    - 갑작스러운 차선 변경이나 브레이크를 밟는 타이밍이 늦어지는 등 위험 상황에서 적절한 대처가 불가능해짐
    - 이러한 반응 시간 지연은 교차로, 횡단보도와 같은 중요한 도로 구간에서 사고 발생률을 증가시킴.

## **📃 3. 사용 데이터**

- Kaggle의 "RevitsOne 5-Class Driver Behavior Dataset" 사용
- 운전자의 다양한 행동을 5가지 클래스로 분류한 데이터셋 (졸음운전, 휴대폰 사용 등)
- 이미지 데이터를 활용하여 행동 패턴 분석

- 데이터 정의표

    |컬럼명|유형|설명|이미지|
    |-----|---|----|---- |
    |Safe Driving|이미지|안전 운전 이미지|![safe](/assets/img/safe_position.png)|
    |Talking Phone|이미지|전화 통화 중 이미지|![talking](/assets/img/phone_position.png)|
    |Texting Phone|이미지|문자 작성 이미지|![text](/assets/img/texting_position.png)|
    |Turning|이미지|뒤돌아보는 이미지|![turn](/assets/img/turn_position.png)|
    |Other Activities|이미지|이외의 다른 문제 행동|![other](/assets/img/other_position.png)|

## **📊 4. 데이터 전처리**

- 손상데이터 처리
![image](/assets/img/preprocessing1.png)
    - 데이터 내에 손상된 이미지 발견
    - 손상된 이미지를 제거함으로써, 모델 학습에 사용될 데이터셋의 무결성을 유지 
    - 총 15개의 손상된 이미지를 제거한 후, 남은 데이터는 안정적이며 학습에 적합한 상태로 준비 

## **📈 5. EDA**

### 클래스별 이미지 수 확인

![클래스별비율](/assets/img/class_rate.png)
- 전반적으로 클래스 별 이미지 수가 비슷한 수준이기 때문에 클래스 별 비율 조절은 필요없다고 판단하였음

### 이미지 사이즈 확인
![이미지 사이즈](/assets/img/img_size.png)
- 이미지 크기가 640x480인 데이터와 680x390인 데이터가 있음
- 이미지 비율이 같은지를 확인하여 단순히 이미지를 크기만 줄일지 이미지에 다른 기법을 적용해야할지 판단이 필요
- 이미지의 비율을 분석하여 추가적인 분석 실시

### 이미지 비율 확인
![이미지 비율](/assets/img/aspec_ratio.png)
- 현재 이미지의 종횡비가 1.33인 이미지와 1.78인 이미지 두가지가 존재함을 확인함
- 이미지의 종횡비를 고려하지 않고 이미지 크기를 변경할 경우 이미지에 왜곡이 생겨 정확한 분석이 어려울 수 있음
- 이미지 종횡비를 맞춰주기위한 탐색이 필요

**[전체 데이터 이미지 비율]**

- Mean Aspect Ratio: 1.50
- Median Aspect Ratio: 1.33
- Mode Aspect Ratio: 1.33
- Standard Deviation: 0.21
- 이미지의 평균이 1.50이고 중간값이 1.33인 것을 보아 1.33의 이미지가 더 많다고 판단됨

### 클래스 별 이미지 비율 확인
![클래스 별 이미지 비율](/assets/img/class_aspect_ratio.png)

- 모든 클래스에서 비슷한 비율로 1.78의 이미지가 나타남
- 현재 1.33인 데이터에 비해 1.78인 데이터 수가 매우 적은 것을 확인할 수 있음
- 현재 주요 타깃은 이미지의 정중앙에 존재하는 사람의 행동이기 때문에 끝부분을 잘라도 무방하다고 판단됨
- 이미지 전처리에 들어가는 시간과 현재 이미지들의 특성을 고려 이미지의 종횡비가 1.33이 되도록 이미지를 잘라냄

### 이미지 픽셀 분포 확인
![픽셀분포](/assets/img/pixel_dist.png)
- 현재 이미지 데이터들의 색조가 어두운 부분과 밝은 부분 양측으로 나누어져 분포하며 굉장히 대조가 강한 이미지라는 것을 알 수 있음
- 데이터의 분포가 균일하지 않아 모델이 학습하는 과정에서 바이어스가 발생할 수 있다고 판단됨
- 전체적인 픽셀의 분포를 평활화하는 과정이 필요하다고 판단됨
- 이를 위한 전처리 코드 작성

### 평활화
![평활화](/assets/img/dist_smoothing.png)
![평활화전후 비교](/assets/img/orgin_image.png)
- 이미지가 전체적으로 밝고 분포가 고루 분포하도록 변경 완료
- 이미지의 픽셀 분포를 변경한 것으로 모델이 이미지의 특성을 더 잘 분석할 수 있을 것이라고 기대됨

## **🤖 6. AI 모델 개발**
### 적용 모델
공간의 특성을 파악하여 분석할 수 있는 CNN 모델이 가장 적합하다고 판단이 되어 CNN모델을 이용해 운전자의 행동을 분석하는 모델 개발

### 모델 구조
![모델 구조](/assets/img/model_structure.png)
- 합성곱 신경망, 풀링층 반복적으로 쌓아 이미지의 특성을 분석할 수 있는 CNN모델 설계

### 모델 구축
#### 데이터 분할
![분할](/assets/img/split.png)
- 데이터를 학습용 데이터 7524개, 검증용 데이터 1612개, 시험용 데이터 1612개로 분할

![분할 결과](/assets/img/split_conclusion.png)
- 분할된 데이터의 클래스별 이미지 수가 다 적절하게 나누어진 것을 확인

#### 이미지 생성기 구축
![이미지 생성기](/assets/img/generator_code.png)
- 이미지 전처리 및 파이프라인 구성을 위한 데이터 생성기 구축

#### 모델 학습
![정확도](/assets/img/cnn_accuracy.png)
![손실함수](/assets/img/cnn_loss.png)
- 모델이 반복학습하며 성능이 상승하는 모습을 보임
- 6-7 회 반복 이후로 성능이 크게 증가하는 모습은 보이지 않음
- 최적의 학습횟수는 7회로 판단

### 모델 평가

#### 평가지표
![acc_loss](/assets/img/acc_loss.png)
- accuracy(정확도)가 0.91, loss(손실률)가 0.38로 높은 성능의 모델 구축 

![clssification_report](/assets/img/report.png)
- 평균 f1스코어가 약 0.9로 상당히 준수한 성능을 나타냄

![confusion_matrix](/assets/img/confusion_matrix.png)
- 대부분의 이미지의 클래스를 정확히 맞춤
- Talk와 Other에서 오류가 약 50개 가량 발생하는 모습이 나타남 
- 일정 클래스의 이미지를 잘 분류를 하지 못하는 문제를 개선해야할 필요가 있음

#### 평가 결과
- 준수한 성능을 가져 데이터를 잘 분리하는 모델 구축 완료
- 현재 모델의 성능이 준수하기는 하나 일부 클래스에서 모델의 성능이 더 발전할 가능성이 있음
- 또한 현재 모델은 단순한 형태의 CNN이기 때문에 소형 기기에서 동작 시 자원이 부족할 가능성이 있음
- 이를 개선하기 위해 모델을 변경하여 개선 시도

### 모델 개선
#### 적용 모델
- 해당 모델은 목적 상 블랙 박스 안에 들어가는 모델이기 때문에 경량화가 중요함 
- MobileNet은 휴대용 기기나 작은 IoT 기기에 적용할 것을 고려하고 개발된 모델로 소형 기기에서 이미지 분류를 할 때 유용한 모델임
- 따라서 이동 기기 및 IoT기기에서 적절하게 사용 가능한 MobilNet을 사용하여 분석 모델을 개발

#### 모델 학습
![acc](/assets/img/mobilenet_acc.png)
![loss](/assets/img/mobilenet_loss.png)
- 학습이 반복되며 성능이 개선되는 모습을 볼 수 있음
- Accuracy는 약 0.9이상, Loss는 0.2-0.4 사이로 이미지 판별에 정확도가 높고 오차가 적게 나타나는 것을 확인함
- 모델이 제대로 학습되었다고 판단

#### 모델 평가
![acc_loss](/assets/img/mobilenet_acc_loss.png)
- Accuracy가 0.93, Loss가 0.18로 기존의 CNN보다 정확도가 높아지고 오차 발생이 감소하여 더 성능이 좋은 모델을 구축할 수 있었음

![report](/assets/img/mobilenet_report.png)
- 평균 f1스코어가 약 0.94로 기존의 CNN 모델에 비해서 상당히 개선됨

![matrix](/assets/img/mobilenet_matrix.png)
- 이전의 모델과 달리 Talk과 Other도 잘 분류하는 모습을 볼 수 있음
- 전체적으로 이미지를 균일하게 분류하는 모습을 확인 할 수 있음
- 모델을 변경한 것으로 클래스에 따라 이미지 분류가 잘되지 않는 문제를 어느 정도 해결함

**[결과]**
- 모델을 기본적인 CNN에서 MobileNet으로 변경한 것으로 Accuracy, Loss, F-1 스코어에서 성능 향상을 가져올 수 있었음
- 운전자 행동을 분석할 수 있는 모델을 개발 완료하였으므로 이를 이용하여 외부 이미지에 대한 분류를 실행할 수 있는 솔루션을 개발
- 일부 클래스에서 제대로 분류하지 못하는 문제를 해결

## **💡 7. 결론**
### 생성된 모델을 이용한 운전자 행동 패턴 분석 솔루션

![솔루션](/assets/img/solution.png)

- 이미지를 입력하면 해당 이미지 속 운전자의 행동을 분석할 수 있는 솔루션 개발
- 현재 입력한 이미지는 문자를 보내는 이미지로 84%의 정확도로 분류를 시행하였음을 확인 가능
- 이 솔루션을 통해 운전자가 운전 중 다른 행동을 하는 것을 판단이 가능
- 운전자가 운전 이외의 행동을 하는 경우에 경고 알림 등을 보내는 형식으로 운전에 집중할 수 있게 될 것으로 기대
- 결과적으로 운전자의 부주의로 교통사고가 발생하는 것을 예방할 수 있을 것이라 기대